function exportJSON(){if(saveMe()){var e={},t;for(var n=0;n<localStorage.length;n++)t=localStorage.key(n),e[""+t+""]=localStorage.getItem(localStorage.key(n));var r=new Blob([JSON.stringify(e)],{type:"application/json"}),i=URL.createObjectURL(r);console.log("Veamos la cosa del archivo generado "+i);var s=document.getElementById("export");s.href=i;var o=new Date,u=localStorage.name?localStorage.getItem("name"):"MVPmc",a=u.replace(/[^A-Z0-9]+/ig,"_");s.download=a+"_"+o+".json"}}function trashMe(){ls&&localStorage.clear(),$("#mvp_features").html(""),$("#lffd").html(""),$("#lfsd").html(""),$("#hfsd").html(""),$("#hffd").html(""),$("#name").val(""),$("#idea").val("")}function changeStateOfSaved(e){e?$(".save").addClass("glyphicon-floppy-saved").removeClass("glyphicon-floppy-disk"):$(".save").addClass("glyphicon-floppy-disk").removeClass("glyphicon-floppy-saved")}function saveMe(){return ls?(localStorage.setItem("mvp_features",$("#mvp_features").html()),localStorage.setItem("lffd",$("#lffd").html()),localStorage.setItem("lfsd",$("#lfsd").html()),localStorage.setItem("hfsd",$("#hfsd").html()),localStorage.setItem("hffd",$("#hffd").html()),localStorage.setItem("name",$("#name").val()),localStorage.setItem("idea",$("#idea").val()),!0):!1}function loadFromLocalStorage(){ls&&(localStorage.mvp_features&&$("#mvp_features").html(localStorage.getItem("mvp_features")),localStorage.lffd&&$("#lffd").html(localStorage.getItem("lffd")),localStorage.lfsd&&$("#lfsd").html(localStorage.getItem("lfsd")),localStorage.hfsd&&$("#hfsd").html(localStorage.getItem("hfsd")),localStorage.hffd&&$("#hffd").html(localStorage.getItem("hffd")),localStorage.idea&&$("#idea").val(localStorage.getItem("idea")),localStorage.name&&$("#name").val(localStorage.getItem("name")))}function readSingleFile(e){var t=e.target.files[0];if(!t)return;var n=new FileReader;n.onload=function(e){var t=e.target.result;displayContents(t)},n.readAsText(t)}function displayContents(e){var t=document.getElementById("file-content");t.innerHTML=e}function loadFile(e){function n(e){trashMe(),lines=e.target.result;var t=JSON.parse(lines);t.idea?$("#idea").val(t.idea):"",t.name?$("#name").val(t.name):"",t.mvp_features?$("#mvp_features").html(t.mvp_features):"",t.lffd?$("#lffd").html(t.lffd):"",t.lfsd?$("#lfsd").html(t.lfsd):"",t.hfsd?$("#hfsd").html(t.hfsd):"",t.hffd?$("#hffd").html(t.hffd):""}var t;if(typeof window.FileReader!="function"){$(".modal-body #message").html("The file API isn't supported on this browser yet :("),$("#modal_message").modal("show");return}if(!e)return;t=new FileReader,t.onload=n,t.readAsText(e)}function checkLocalStorageData(){return localStorage.idea||localStorage.idea===""&&localStorage.name||localStorage.name===""&&localStorage.mvp_features||localStorage.mvp_features===""&&localStorage.lffd||localStorage.lffd===""&&localStorage.lfsd||localStorage.lfsd===""&&localStorage.hfsd||localStorage.hfsd===""&&localStorage.hffd||localStorage.hffd===""?!0:!1}function initMVP(){var e=document.createElement("li");e.innerHTML='<i class="js-remove">✖ </i>Drag some features',mvpf.el.appendChild(e);var e=document.createElement("li");e.innerHTML='<i class="js-remove">✖ </i>Keep in mind and promove to the next version',lffd.el.appendChild(e);var e=document.createElement("li");e.innerHTML='<i class="js-remove">✖ </i>It will not be part of your 1st MVP',lfsd.el.appendChild(e);var e=document.createElement("li");e.innerHTML='<i class="js-remove">✖ </i>Try fast or carry over to the next version',hfsd.el.appendChild(e);var e=document.createElement("li");e.innerHTML='<i class="js-remove">✖ </i>This stuff must be part of your 1st MVP',hffd.el.appendChild(e)}function colorMe(e){switch(e){case"button_yellow":color_class="yellowm";break;case"button_green":color_class="greenm";break;case"button_red":color_class="redm"}}function takeAndExportScreenshot(){showButtons(!1),html2canvas(document.body,{onrendered:function(e){e.toBlob&&e.toBlob(function(e){var t=localStorage.name?localStorage.getItem("name"):"MVPmc",n=t.replace(/[^A-Z0-9]+/ig,"_");saveAs(e,n+".png")},"image/png"),showButtons(!0)}})}function showButtons(e){e?(document.getElementById("button_actions").style.display="block",document.getElementById("new_feature_hfsd").style.display="block",document.getElementById("new_feature_hffd").style.display="block",document.getElementById("new_feature_lffd").style.display="block",document.getElementById("new_feature_lfsd").style.display="block"):(document.getElementById("button_actions").style.display="none",document.getElementById("new_feature_hfsd").style.display="none",document.getElementById("new_feature_hffd").style.display="none",document.getElementById("new_feature_lffd").style.display="none",document.getElementById("new_feature_lfsd").style.display="none")}var hffd,hfsd,lffd,lfsd,mvpf,ls,color_class;$(document).ready(function(){var e,t=document.getElementById("hffd");hffd=Sortable.create(t,{group:"mvpcm",animation:150,ghostClass:"ghost",filter:".js-remove",onFilter:function(e){e.item.parentNode.removeChild(e.item),changeStateOfSaved(!1)},onEnd:function(e){changeStateOfSaved(!1)}});var n=$("#hfsd")[0];hfsd=Sortable.create(n,{group:"mvpcm",animation:150,ghostClass:"ghost",filter:".js-remove",onFilter:function(e){e.item.parentNode.removeChild(e.item),changeStateOfSaved(!1)},onEnd:function(e){changeStateOfSaved(!1)}});var r=$("#lfsd")[0];lfsd=Sortable.create(r,{group:"mvpcm",animation:150,ghostClass:"ghost",filter:".js-remove",onFilter:function(e){e.item.parentNode.removeChild(e.item),changeStateOfSaved(!1)},onEnd:function(e){changeStateOfSaved(!1)}});var i=$("#lffd")[0];lffd=Sortable.create(i,{group:"mvpcm",animation:150,ghostClass:"ghost",filter:".js-remove",onFilter:function(e){e.item.parentNode.removeChild(e.item),changeStateOfSaved(!1)},onEnd:function(e){changeStateOfSaved(!1)}});var s=$("#mvp_features")[0];mvpf=Sortable.create(s,{group:"mvpcm",animation:150,ghostClass:"ghost",store:{get:function(e){var t=localStorage.getItem(e.options.group);return t?t.split("|"):[]},set:function(e){var t=e.toArray();localStorage.setItem(e.options.group,t.join("|"))}},filter:".js-remove",onFilter:function(e){e.item.parentNode.removeChild(e.item),changeStateOfSaved(!1)},onEnd:function(e){changeStateOfSaved(!1)}}),button_add_feature.onclick=function(){var t=$("#feature").val().trim();if(!t)return;var n=document.createElement("li");n.innerHTML='<i class="js-remove">✖ </i>'+t,color_class!=""&&(n.className=n.className+color_class);var r=e.split("_");switch(r[2]){case"lffd":lffd.el.appendChild(n);break;case"lfsd":lfsd.el.appendChild(n);break;case"hffd":hffd.el.appendChild(n);break;case"hfsd":hfsd.el.appendChild(n)}$("#modal_new_feature").modal("hide"),changeStateOfSaved(!1),color_class=""},$("#modal_new_feature").on("show.bs.modal",function(t){setTimeout(function(){$("#feature").focus(),$("#feature").addClass("focusedInput")},500);var n=$(t.relatedTarget);e=n[0].id,$("#feature").val("")}),$("#button_save").on("click",function(){saveMe()?changeStateOfSaved(!0):(changeStateOfSaved(!1),$(".modal-body #message").html("Can not save mvp, localStorage is not available"),$("#modal_message").modal("show"))}),$("#trash").on("click",function(){trashMe()}),$("#export").on("click",function(){exportJSON()}),typeof Storage!="undefined"?(ls=!0,checkLocalStorageData()?loadFromLocalStorage():initMVP()):($("#button_save").prop("disabled",!0),ls=!1,initMVP()),$('[data-toggle="tooltip"]').tooltip(),$("#screenshot").on("click",function(){$("#screenshot").tooltip("hide"),setTimeout(function(){takeAndExportScreenshot()},350)})}),$(document).on("change",".btn-file :file",function(){var e=$(this),t=e.get(0).files?e.get(0).files.length:1,n=e.val().replace(/\\/g,"/").replace(/.*\//,""),r=e[0].files[0];loadFile(r)});